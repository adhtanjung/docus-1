---
title: Effective Dating
description: How HAER manages time-based records and structural changes.
---

# Effective Dating

Effective dating is the architectural foundation of HAER. It allows the system to manage records that change over time, ensuring that the organization can plan for the future while maintaining a perfect record of the past.

## Concept: Point-in-Time Truth

Unlike traditional systems that only store the "now", HAER stores the "when". Every core entity (Organizations, Positions, Jobs, Persons) is defined by its window of effectiveness.

### Key Fields

- **`valid_from`**: The start of the effectiveness window.
- **`valid_to`**: The end of the effectiveness window (null if currently active indefinitely).
- **`version`**: An incrementing counter used to sequence changes to the same business object.
- **`is_current`**: A flag indicating if this is the active record in the current timeline.
- **`code`**: The immutable **Business ID** (e.g., `DEPT-IT`) that links all versions of an object together.

## How it Works: The Timeline

### 1. Creating a Record

When you create a new entity, you specify its `valid_from`.

- If you don't provide one, it defaults to the current date.
- The record starts with `version: 1` and `is_current: true`.

### 2. Updating a Record (Future or Present)

When you update a record (e.g., changing a department name), you provide a new `valid_from` for the change.

- **Previous Version**: The system closes the previous version by setting its `valid_to` to the day before the new change and setting `is_current: false`.
- **New Version**: A new record is created with the updated data, the new `valid_from`, and `version = old_version + 1`.

### 3. Same-Day Correction

If a mistake is made and an update is performed on the **same day** as the `valid_from` date:

- The system performs an **in-place update** on the existing record.
- No new version is created.
- This maintains clean data without unnecessary version bloat for simple typos.

## Temporal Modes

HAER enforces how versions can interact through **Temporal Modes**:

### Non-Overlapping (Standard)

Most core entities use this mode.

- **Constraint**: Only one version for a specific `code` can be active on any given date.
- **Enforcement**: The system automatically validates and prevents overlapping date ranges to ensure there is never ambiguity about which record is "the truth" for a specific date.

### Overlapping (Specialized)

Used for specific scenarios like "Temporary Assignments" or "Concurrent Roles" where an individual or object may have multiple active states simultaneously.

## Querying the Timeline

To find the state of an entity on a specific `TargetDate`, HAER uses the following logic:

```sql
SELECT * FROM table
WHERE code = 'BUSINESS_CODE'
  AND valid_from <= 'TargetDate'
  AND (valid_to IS NULL OR valid_to >= 'TargetDate')
```

This "Point-in-Time" query ensures that reports, payroll, and organizational charts are always accurate relative to the date being viewed.
