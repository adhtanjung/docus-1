---
title: Branching Strategy
description: Source control, branch types, and merge rules.
---

# Source Control & Branching Strategy

A disciplined branching strategy is the foundation of a reliable release process. This page defines the branch types, naming conventions, and rules for the HAER codebase.

## Branch Types & Naming Conventions

| Branch Pattern | Purpose                                                            | Lifespan    |
| :------------- | :----------------------------------------------------------------- | :---------- |
| `main`         | Production-ready code. Always deployable.                          | Permanent   |
| `develop`      | Integration branch for upcoming releases.                          | Permanent   |
| `release/*`    | Stabilization for a specific release (e.g., `release/1.5.0`).      | Short-lived |
| `feature/*`    | New features or enhancements (e.g., `feature/add-leave-approval`). | Short-lived |
| `hotfix/*`     | Critical production fixes (e.g., `hotfix/login-security-patch`).   | Short-lived |
| `bugfix/*`     | Non-critical bug fixes for the develop branch.                     | Short-lived |

## Rules Per Branch

### `main`

- **Protected**: No direct commits allowed.
- **Merge Source**: Only from `release/*` or `hotfix/*` branches.
- **CI Requirement**: All tests must pass; security scan clean.
- **Approval**: Minimum 2 reviewers required.
- **Environment**: Maps to **Production**.

### `develop`

- **Protected**: No direct commits allowed.
- **Merge Source**: From `feature/*` and `bugfix/*` branches.
- **CI Requirement**: All tests must pass.
- **Approval**: Minimum 1 reviewer required.
- **Environment**: Maps to **Staging / QA**.

### `feature/*` and `bugfix/*`

- **Lifespan**: Should be short-lived (ideally < 1 week).
- **Scope**: Single responsibility per branch.
- **Base**: Always branch from `develop`.
- **Target**: Always merge back into `develop`.

### `release/*`

- **Purpose**: Code freeze and stabilization before a production release.
- **Base**: Branched from `develop`.
- **Target**: Merged into both `main` and `develop` upon release.
- **Allowed Changes**: Only bug fixes; no new features.

### `hotfix/*`

- **Purpose**: Emergency fixes for production issues.
- **Base**: Branched from `main`.
- **Target**: Merged into both `main` and `develop`.
- **Urgency**: Bypasses normal release cycle but still requires CI and review.

## Merge Strategy

| Branch                  | Merge Method                                 |
| :---------------------- | :------------------------------------------- |
| `feature/*` → `develop` | **Squash Merge** (clean history)             |
| `release/*` → `main`    | **Merge Commit** (preserves release context) |
| `hotfix/*` → `main`     | **Merge Commit**                             |

## Environment Mapping

| Branch      | Environment                    |
| :---------- | :----------------------------- |
| `main`      | Production                     |
| `develop`   | Staging / QA                   |
| `feature/*` | Preview / Ephemeral (optional) |

## Key Principles

::prose-note
**Golden Rule**: Never commit directly to `main` or `develop`. All changes go through a Pull Request.
::

- **Single Responsibility**: One feature or fix per branch.
- **Short-Lived Branches**: Long-running branches lead to merge conflicts and integration pain.
- **Clean History**: Squash merges keep the main history readable.
